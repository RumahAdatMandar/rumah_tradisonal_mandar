<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Virtual Tour: Rumah Boyang Mandar</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"
    />
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
  </head>
  <body>
    <div class="app">
      <aside id="sidebar">
        <h1>Virtual Tour: Rumah Adat Mandar</h1>
        <p class="meta">
          Jelajahi setiap sudut Rumah Adat Mandar (Boyang).<br />
          Klik pada salah satu titik di bawah untuk langsung menuju lokasi.
        </p>
        <div id="sceneGrid" class="grid"></div>
        <div class="controls">
          <button id="prevBtn" title="Scene sebelumnya">◀ Sebelumnya</button>
          <button id="nextBtn" title="Scene berikutnya">Berikutnya ▶</button>
        </div>
      </aside>
      <main id="panorama"></main>
    </div>

    <script>
      // === BAGIAN KONFIGURASI PENTING ===
      const START_INDEX = 0;
      const END_INDEX = 9;

      // Daftar Nama Scene (TETAP ADA)
      const sceneTitles = [
        "Halaman Depan", // 0
        "Naik Tangga", // 1
        "Ruangan Utama 1", // 2
        "Ruangan Utama 2", // 3
        "Teras 1", // 4
        "Teras 2", // 5
        "Penghubung (Dapur)", // 6
        "Dapur", // 7
        "Tangga Belakang", // 8
        "Naong Boyang", // 9
      ];

      // Path file panorama berdasarkan nomor
      const panoPath = (i) => `panos/image${i}.jpg`;
      const sceneId = (i) => `scene-${i}`;

      // Koordinat Yaw & Pitch Anda (TETAP SAMA)
      const overrides = {
        0: {
          // Halaman Depan
          next: { yaw: -147, pitch: 3 }, // Arahkan ke tangga
        },
        1: {
          // Naik Tangga
          next: { yaw: 3, pitch: 6.3 }, // Arahkan ke pintu Ruangan Utama 1
          prev: { yaw: -180, pitch: -44 }, // Arahkan kembali ke Halaman Depan
        },
        2: {
          // Ruangan Utama 1
          next: { yaw: -104, pitch: -1 }, // Arahkan ke Ruangan Utama 2
          prev: { yaw: 65, pitch: -1.991 }, // Arahkan kembali ke Pintu (Naik Tangga)
        },
        3: {
          // Ruangan Utama 2
          next: { yaw: -140, pitch: 4 }, // Arahkan ke Teras 1
          prev: { yaw: 100, pitch: 0 }, // Arahkan kembali ke Ruangan Utama 1
        },
        4: {
          // Teras 1
          next: { yaw: -5, pitch: -18 }, // Arahkan ke Teras 2
          prev: { yaw: -128, pitch: -8 }, // Arahkan kembali ke Ruangan Utama 2
        },
        5: {
          // Teras 2
          next: { yaw: 146, pitch: -1 }, // Arahkan ke Penghubung Dapur
          prev: { yaw: 173, pitch: -1 }, // Arahkan kembali ke Teras 1
        },
        6: {
          // Penghubung (Dapur)
          next: { yaw: 175, pitch: -2 }, // Arahkan ke Dapur
          prev: { yaw: 15, pitch: -4 }, // Arahkan kembali ke Teras 2
        },
        7: {
          // Dapur
          next: { yaw: -147, pitch: 0 }, // Arahkan ke Tangga Belakang
          prev: { yaw: -98, pitch: -5 }, // Arahkan kembali ke Penghubung
        },
        // Tangga Belakang
        8: {
          next: { yaw: -161, pitch: -1 }, // Arahkan ke Naong Boyang
          prev: { yaw: 2, pitch: 21 }, // Arahkan kembali ke Dapur
        },
        // Naong Boyang
        9: {
          prev: { yaw: 180, pitch: 0 }, // Arahkan kembali ke Tangga Belakang
        },
      };

      const config = {
        default: {
          firstScene: sceneId(START_INDEX),
          autoLoad: true,
          showControls: true,
          compass: false,
          hfov: 110,
          keyboardZoom: true,
          hotSpotDebug: true,
        },
        scenes: {},
      };

      for (let i = START_INDEX; i <= END_INDEX; i++) {
        const nextOverride = overrides[i]?.next || {};
        const prevOverride = overrides[i]?.prev || {};

        // Teks hotspot TETAP MENGGUNAKAN NAMA (cth: "Menuju: Naik Tangga")
        const nextHotspotConfig = {
          yaw: nextOverride.yaw || 0,
          pitch: nextOverride.pitch || 0,
          text: nextOverride.text || `Menuju: ${sceneTitles[i + 1]}`,
        };

        const prevHotspotConfig = {
          yaw: prevOverride.yaw || 180,
          pitch: prevOverride.pitch || 0,
          text: prevOverride.text || `Kembali ke: ${sceneTitles[i - 1]}`,
        };

        config.scenes[sceneId(i)] = {
          // Judul scene TETAP MENGGUNAKAN NAMA (cth: "Halaman Depan")
          title: sceneTitles[i] || `Spot ${i}`,
          type: "equirectangular",
          panorama: panoPath(i),
          hotSpots: [
            ...(i > START_INDEX
              ? [
                  {
                    yaw: prevHotspotConfig.yaw,
                    pitch: prevHotspotConfig.pitch,
                    type: "scene",
                    text: prevHotspotConfig.text,
                    sceneId: sceneId(i - 1),
                  },
                ]
              : []),
            ...(i < END_INDEX
              ? [
                  {
                    yaw: nextHotspotConfig.yaw,
                    pitch: nextHotspotConfig.pitch,
                    type: "scene",
                    text: nextHotspotConfig.text,
                    sceneId: sceneId(i + 1),
                  },
                ]
              : []),
          ],
        };
      }

      // Inisialisasi viewer Pannellum
      const viewer = pannellum.viewer("panorama", config);

      // === Logika untuk UI (Sidebar dan Tombol) ===
      const grid = document.getElementById("sceneGrid");
      for (let i = START_INDEX; i <= END_INDEX; i++) {
        const b = document.createElement("button");
        b.className = "scene-btn";

        // === PERUBAHAN SATU-SATUNYA DI SINI ===
        // Tombol di sidebar diubah menjadi angka (0, 1, 2, ...)
        b.textContent = i;

        b.dataset.scene = sceneId(i);
        b.onclick = () => viewer.loadScene(sceneId(i));
        grid.appendChild(b);
      }

      const setActive = () => {
        const current = viewer.getScene();
        document.querySelectorAll(".scene-btn").forEach((btn) => {
          btn.classList.toggle("active", btn.dataset.scene === current);
        });
      };
      viewer.on("load", setActive);
      setActive();

      // Navigasi tombol prev/next di sidebar
      const idxFromScene = (sid) => parseInt(sid.split("-")[1], 10);
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");

      prevBtn.onclick = () => {
        const i = idxFromScene(viewer.getScene());
        if (i > START_INDEX) viewer.loadScene(sceneId(i - 1));
      };
      nextBtn.onclick = () => {
        const i = idxFromScene(viewer.getScene());
        if (i < END_INDEX) viewer.loadScene(sceneId(i + 1));
      };
    </script>
  </body>
</html>
